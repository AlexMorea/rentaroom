{% extends "listings/base.html" %} {% load static %} {% block content %}

<h1 class="page-title">{{ room.title }}</h1>

<div class="room-card" style="max-width: 900px; margin: 0 auto">
  <div class="room-media">
    <div class="image-slider">
      {% for img in room.images.all|slice:":10" %}
      <img src="{{ img.image.url }}" alt="Room image" />
      {% empty %}
      <img src="{% static 'img/placeholder.jpg' %}" alt="No image" />
      {% endfor %}
    </div>
  </div>

  <div class="room-info">
    <p class="room-meta"><strong>Location:</strong> {{ room.location }}</p>
    <p class="room-price">R {{ room.price }}</p>
    <p class="room-meta">
      <strong>Type:</strong> {{ room.get_room_type_display }}
    </p>

    <p style="margin-top: 10px">{{ room.description }}</p>

    <hr style="margin: 16px 0; opacity: 0.25" />

    <h3 style="margin: 0 0 10px">Contact landlord</h3>

    <div style="display: flex; gap: 10px; flex-wrap: wrap">
      {% if room.contact_phone %}
      <a class="btn-primary" href="{% url 'track_contact' room.id 'phone' %}"
        >ðŸ“ž Call</a
      >
      {% endif %} {% if room.contact_whatsapp or room.contact_phone %}
      <a class="btn-primary" href="{% url 'track_contact' room.id 'whatsapp' %}"
        >ðŸ’¬ WhatsApp</a
      >
      {% endif %} {% if room.owner.email or room.contact_email %}
      <a class="btn-primary" href="{% url 'track_contact' room.id 'email' %}"
        >ðŸ“§ Email</a
      >
      {% endif %}
    </div>

    <hr style="margin: 16px 0; opacity: 0.25" />

    <form method="post" action="{% url 'mark_success' room.id %}">
      {% csrf_token %}
      <button type="submit" class="btn-secondary">
        âœ… I successfully found a place
      </button>
    </form>

    <h3 style="margin-top: 18px">Leave a review</h3>

    {% if user.is_authenticated %}
    <form method="post" action="{% url 'add_review' room.id %}">
      {% csrf_token %}
      <label>Rating:</label>
      <select name="rating" class="input" style="max-width: 160px">
        {% for i in "12345" %}
        <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>

      <div style="margin-top: 10px">
        <textarea
          name="comment"
          class="input textarea"
          placeholder="Write your review..."
        ></textarea>
      </div>

      <button type="submit" class="btn-primary" style="margin-top: 10px">
        Submit Review
      </button>
    </form>
    {% else %}
    <p><em>Please log in to leave a review.</em></p>
    {% endif %}
  </div>
</div>

{% endblock %}
